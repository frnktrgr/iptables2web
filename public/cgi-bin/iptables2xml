<iptables-rules version="1.0">
<!-- # Generated by iptables*-save v1.6.1 on Sat Mar  2 17:56:45 2019 -->
  <table name="nat" >
    <chain name="PREROUTING" policy="ACCEPT" packet-count="43009" byte-count="3308714" >
      <rule packet-count="29790" byte-count="1968326" >
       <conditions>
        <addrtype >
          <dst-type >LOCAL</dst-type>
        </addrtype>
       </conditions>
       <actions>
        <call >
          <DOCKER />
        </call>
       </actions>

      </rule>

    </chain>
    <chain name="OUTPUT" policy="ACCEPT" packet-count="3946" byte-count="281915" >
      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <d  invert="1">127.0.0.0/8</d>
        </match>
        <addrtype >
          <dst-type >LOCAL</dst-type>
        </addrtype>
       </conditions>
       <actions>
        <call >
          <DOCKER />
        </call>
       </actions>

      </rule>

    </chain>
    <chain name="POSTROUTING" policy="ACCEPT" packet-count="3948" byte-count="282035" >
      <rule packet-count="37404" byte-count="2592367" >
       <conditions>
        <match >
          <s >169.254.254.0/24</s>
          <o  invert="1">docker0</o>
        </match>
       </conditions>
       <actions>
        <MASQUERADE  />
       </actions>

      </rule>

      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <s >169.254.254.3/32</s>
          <d >169.254.254.3/32</d>
          <p >tcp</p>
        </match>
        <tcp >
          <dport >80</dport>
        </tcp>
       </conditions>
       <actions>
        <MASQUERADE  />
       </actions>

      </rule>

      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <s >169.254.254.4/32</s>
          <d >169.254.254.4/32</d>
          <p >tcp</p>
        </match>
        <tcp >
          <dport >8080</dport>
        </tcp>
       </conditions>
       <actions>
        <MASQUERADE  />
       </actions>

      </rule>

      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <s >169.254.254.5/32</s>
          <d >169.254.254.5/32</d>
          <p >tcp</p>
        </match>
        <tcp >
          <dport >27017</dport>
        </tcp>
       </conditions>
       <actions>
        <MASQUERADE  />
       </actions>

      </rule>

      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <s >169.254.254.2/32</s>
          <d >169.254.254.2/32</d>
          <p >tcp</p>
        </match>
        <tcp >
          <dport >8080</dport>
        </tcp>
       </conditions>
       <actions>
        <MASQUERADE  />
       </actions>

      </rule>

    </chain>
    <chain name="DOCKER" packet-count="0" byte-count="0" >
      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <i >docker0</i>
        </match>
       </conditions>
       <actions>
        <RETURN  />
       </actions>

      </rule>

      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <d >127.0.0.1/32</d>
          <i  invert="1">docker0</i>
          <p >tcp</p>
        </match>
        <tcp >
          <dport >8081</dport>
        </tcp>
       </conditions>
       <actions>
        <DNAT >
          <to-destination >169.254.254.3:80</to-destination>
        </DNAT>
       </actions>

      </rule>

      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <d >127.0.0.1/32</d>
          <i  invert="1">docker0</i>
          <p >tcp</p>
        </match>
        <tcp >
          <dport >8082</dport>
        </tcp>
       </conditions>
       <actions>
        <DNAT >
          <to-destination >169.254.254.4:8080</to-destination>
        </DNAT>
       </actions>

      </rule>

      <rule packet-count="127" byte-count="7444" >
       <conditions>
        <match >
          <i  invert="1">docker0</i>
          <p >tcp</p>
        </match>
        <tcp >
          <dport >27017</dport>
        </tcp>
       </conditions>
       <actions>
        <DNAT >
          <to-destination >169.254.254.5:27017</to-destination>
        </DNAT>
       </actions>

      </rule>

      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <d >127.0.0.1/32</d>
          <i  invert="1">docker0</i>
          <p >tcp</p>
        </match>
        <tcp >
          <dport >8080</dport>
        </tcp>
       </conditions>
       <actions>
        <DNAT >
          <to-destination >169.254.254.2:8080</to-destination>
        </DNAT>
       </actions>

      </rule>

    </chain>
    <chain name="INPUT" policy="ACCEPT" packet-count="20434" byte-count="1813940" />
  </table>
<!-- # Completed on Sat Mar  2 17:56:45 2019 -->
<!-- # Generated by iptables*-save v1.6.1 on Sat Mar  2 17:56:45 2019 -->
  <table name="filter" >
    <chain name="INPUT" policy="ACCEPT" packet-count="158418" byte-count="69126645" >
      <rule packet-count="296255" byte-count="1129473065" >
       <conditions>
        <match >
          <i >bond0</i>
        </match>
       </conditions>
       <actions>
        <call >
          <FAIL2BAN />
        </call>
       </actions>

      </rule>

      <rule packet-count="296255" byte-count="1129473065" >
       <conditions>
        <match >
          <i >bond0</i>
        </match>
       </conditions>
       <actions>
        <call >
          <FILTERS />
        </call>
       </actions>

      </rule>

    </chain>
    <chain name="FORWARD" policy="DROP" packet-count="0" byte-count="0" >
      <rule packet-count="930107" byte-count="126609503" >
       <actions>
        <call >
          <DOCKER-USER />
        </call>
       </actions>

      </rule>

      <rule packet-count="929988" byte-count="126602539" >
       <actions>
        <call >
          <DOCKER-ISOLATION-STAGE-1 />
        </call>
       </actions>

      </rule>

      <rule packet-count="311153" byte-count="78680642" >
       <conditions>
        <match >
          <o >docker0</o>
        </match>
        <conntrack >
          <ctstate >RELATED,ESTABLISHED</ctstate>
        </conntrack>
       </conditions>
       <actions>
        <ACCEPT  />
       </actions>

      </rule>

      <rule packet-count="10" byte-count="600" >
       <conditions>
        <match >
          <o >docker0</o>
        </match>
       </conditions>
       <actions>
        <call >
          <DOCKER />
        </call>
       </actions>

      </rule>

      <rule packet-count="618825" byte-count="47921297" >
       <conditions>
        <match >
          <i >docker0</i>
          <o  invert="1">docker0</o>
        </match>
       </conditions>
       <actions>
        <ACCEPT  />
       </actions>

      </rule>

      <rule packet-count="2" byte-count="120" >
       <conditions>
        <match >
          <i >docker0</i>
          <o >docker0</o>
        </match>
       </conditions>
       <actions>
        <ACCEPT  />
       </actions>

      </rule>

    </chain>
    <chain name="FILTERS" packet-count="0" byte-count="0" >
      <rule packet-count="437611" byte-count="1151927399" >
       <conditions>
        <conntrack >
          <ctstate >RELATED,ESTABLISHED</ctstate>
        </conntrack>
       </conditions>
       <actions>
        <RETURN  />
       </actions>

      </rule>

      <rule packet-count="99" byte-count="5028" >
       <conditions>
        <match >
          <p >tcp</p>
        </match>
        <tcp >
          <dport >80</dport>
        </tcp>
       </conditions>
       <actions>
        <RETURN  />
       </actions>

      </rule>

      <rule packet-count="920" byte-count="53956" >
       <conditions>
        <match >
          <p >tcp</p>
        </match>
        <tcp >
          <dport >443</dport>
        </tcp>
       </conditions>
       <actions>
        <RETURN  />
       </actions>

      </rule>

      <rule packet-count="16" byte-count="824" >
       <conditions>
        <match >
          <p >tcp</p>   
        </match>
        <tcp >
          <dport >27017</dport>
        </tcp>
       </conditions>
       <actions>
        <call >
          <MONGODB />
        </call>
       </actions>

      </rule>

      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <s >10.188.76.0/22</s>
        </match>
        <comment >
          <comment >&quot;FOO employee&quot;</comment>
        </comment>
       </conditions>
       <actions>
        <RETURN  />
       </actions>

      </rule>

      <rule packet-count="11765" byte-count="859125" >
       <conditions>
        <match >
          <s >10.0.0.0/8</s>
        </match>
        <comment >
          <comment >&quot;BAR private 1&quot;</comment>
        </comment>
       </conditions>
       <actions>
        <RETURN  />
       </actions>

      </rule>

      <rule packet-count="2" byte-count="84" >
       <conditions>
        <match >
          <s >192.0.0.0/8</s>
        </match>
        <comment >
          <comment >&quot;BAR private 2&quot;</comment>
        </comment>
       </conditions>
       <actions>
        <RETURN  />
       </actions>

      </rule>

      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <s >172.16.0.0/12</s>
        </match>
        <comment >
          <comment >&quot;BAR private 3&quot;</comment>
        </comment>
       </conditions>
       <actions>
        <RETURN  />
       </actions>

      </rule>

      <rule packet-count="14446" byte-count="1539143" >
       <conditions>
        <match >
          <s >123.123.0.0/16</s>
        </match>
        <comment >
          <comment >&quot;BAR public&quot;</comment>
        </comment>
       </conditions>
       <actions>
        <RETURN  />
       </actions>

      </rule>

      <rule packet-count="4549" byte-count="229796" >
       <actions>
        <REJECT >
          <reject-with >icmp-port-unreachable</reject-with>
        </REJECT>
       </actions>

      </rule>

    </chain>
    <chain name="MONGODB" packet-count="0" byte-count="0" >
      <rule packet-count="9" byte-count="540" >
       <conditions>
        <match >
          <s >10.23.76.0/22</s>
        </match>
        <comment >
          <comment >&quot;FOO employee&quot;</comment>
        </comment>
       </conditions>
       <actions>
        <ACCEPT  />
       </actions>

      </rule>

      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <s >10.11.12.13/32</s>
        </match>
        <comment >
          <comment >&quot;jane VPN&quot;</comment>
        </comment>
       </conditions>
       <actions>
        <ACCEPT  />
       </actions>

      </rule>

      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <s >10.11.12.14/32</s>
        </match>
        <comment >
          <comment >&quot;bob VPN&quot;</comment>
        </comment>
       </conditions>
       <actions>
        <ACCEPT  />
       </actions>

      </rule>

      <rule packet-count="7" byte-count="284" >
       <actions>
        <REJECT >
          <reject-with >icmp-port-unreachable</reject-with>
        </REJECT>
       </actions>

      </rule>

    </chain>
    <chain name="DOCKER" packet-count="0" byte-count="0" >
      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <d >169.254.254.3/32</d>
          <i  invert="1">docker0</i>
          <o >docker0</o>
          <p >tcp</p>
        </match>
        <tcp >
          <dport >80</dport>
        </tcp>
       </conditions>
       <actions>
        <ACCEPT  />
       </actions>

      </rule>

      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <d >169.254.254.4/32</d>
          <i  invert="1">docker0</i>
          <o >docker0</o>
          <p >tcp</p>
        </match>
        <tcp >
          <dport >8080</dport>
        </tcp>
       </conditions>
       <actions>
        <ACCEPT  />
       </actions>

      </rule>

      <rule packet-count="8" byte-count="480" >
       <conditions>
        <match >
          <d >169.254.254.5/32</d>
          <i  invert="1">docker0</i>
          <o >docker0</o>
          <p >tcp</p>
        </match>
        <tcp >
          <dport >27017</dport>
        </tcp>
       </conditions>
       <actions>
        <ACCEPT  />
       </actions>

      </rule>

      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <d >169.254.254.2/32</d>
          <i  invert="1">docker0</i>
          <o >docker0</o>
          <p >tcp</p>
        </match>
        <tcp >
          <dport >8080</dport>
        </tcp>
       </conditions>
       <actions>
        <ACCEPT  />
       </actions>

      </rule>

    </chain>
    <chain name="DOCKER-ISOLATION-STAGE-1" packet-count="0" byte-count="0" >
      <rule packet-count="618825" byte-count="47921297" >
       <conditions>
        <match >
          <i >docker0</i>
          <o  invert="1">docker0</o>
        </match>
       </conditions>
       <actions>
        <call >
          <DOCKER-ISOLATION-STAGE-2 />
        </call>
       </actions>

      </rule>

      <rule packet-count="929988" byte-count="126602539" >
       <actions>
        <RETURN  />
       </actions>

      </rule>

    </chain>
    <chain name="DOCKER-ISOLATION-STAGE-2" packet-count="0" byte-count="0" >
      <rule packet-count="0" byte-count="0" >
       <conditions>
        <match >
          <o >docker0</o>
        </match>
       </conditions>
       <actions>
        <DROP  />
       </actions>

      </rule>

      <rule packet-count="618825" byte-count="47921297" >
       <actions>
        <RETURN  />
       </actions>

      </rule>

    </chain>
    <chain name="DOCKER-USER" packet-count="0" byte-count="0" >
      <rule packet-count="173153" byte-count="25142290" >
       <conditions>
        <match >
          <i >bond0</i>
        </match>
       </conditions>
       <actions>
        <call >
          <FAIL2BAN />
        </call>
       </actions>

      </rule>

      <rule packet-count="173153" byte-count="25142290" >
       <conditions>
        <match >
          <i >bond0</i>
        </match>
       </conditions>
       <actions>
        <call >
          <FILTERS />
        </call>
       </actions>

      </rule>

    </chain>
    <chain name="f2b-sshd" packet-count="0" byte-count="0" >
      <rule packet-count="604" byte-count="43276" >
       <actions>
        <RETURN  />
       </actions>

      </rule>

    </chain>
    <chain name="OUTPUT" policy="ACCEPT" packet-count="178056" byte-count="41800591" />
    <chain name="FAIL2BAN" packet-count="0" byte-count="0" />
  </table>
<!-- # Completed on Sat Mar  2 17:56:45 2019 -->
</iptables-rules>
